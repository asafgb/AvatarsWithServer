{"version":3,"sources":["../src/index.js"],"names":["kerberos","kerberosModule","require","Kerberos","err","token","cb","authGSSServerInit","context","authGSSServerStep","username","authGSSServerClean"],"mappings":";;;;;;AAAA;;;;AACA;;;;;;AAEA,IAAIA,iBAAJ;;AAEA,IAAI;AACF,MAAMC,iBAAiBC,QAAQ,UAAR,CAAvB;;AAEAF,aAAW,IAAIC,eAAeE,QAAnB,EAAX;AACD,CAJD,CAKA,OAAOC,GAAP,EAAY;AACV,QAAM,kCAAwB,sDAAxB,EAAgFA,GAAhF,CAAN;AACD;;kBAGc,oBAAK,UAACC,KAAD,EAAQC,EAAR,EAAe;AACjCN,WAASO,iBAAT,CAA2B,MAA3B,EAAmC,UAACH,GAAD,EAAMI,OAAN,EAAkB;AACnD,QAAIJ,GAAJ,EAAS;AACP,aAAOE,GAAG,kCAAwB,wCAAxB,EAAkEF,GAAlE,CAAH,CAAP;AACD;;AAEDJ,aAASS,iBAAT,CAA2BD,OAA3B,EAAoCH,KAApC,EAA2C,eAAO;AAChD,UAAID,GAAJ,EAAS;AACP,eAAOE,GAAG,kCAAwB,wCAAxB,EAAkEF,GAAlE,CAAH,CAAP;AACD;;AAH+C,UAKzCM,QALyC,GAK7BF,OAL6B,CAKzCE,QALyC;;;AAOhDV,eAASW,kBAAT,CAA4BH,OAA5B,EAAqC,eAAO;AAC1C,YAAIJ,GAAJ,EAAS;AACP,iBAAOE,GAAG,kCAAwB,yCAAxB,EAAmEF,GAAnE,CAAH,CAAP;AACD;;AAEDE,WAAG,IAAH,EAASI,QAAT;AACD,OAND;AAOD,KAdD;AAeD,GApBD;AAqBD,CAtBc,C","file":"index.js","sourcesContent":["import pify from 'pify';\r\nimport SimpleKerberosError from './simple-kerberos-error';\r\n\r\nlet kerberos;\r\n\r\ntry {\r\n  const kerberosModule = require('kerberos');\r\n\r\n  kerberos = new kerberosModule.Kerberos();\r\n}\r\ncatch (err) {\r\n  throw new SimpleKerberosError('Simple Kerberos failed to load the \"kerberos\" module', err);\r\n}\r\n\r\n\r\nexport default pify((token, cb) => {\r\n  kerberos.authGSSServerInit('HTTP', (err, context) => {\r\n    if (err) {\r\n      return cb(new SimpleKerberosError('Simple Kerberos failed at \"init\" stage', err));\r\n    }\r\n\r\n    kerberos.authGSSServerStep(context, token, err => {\r\n      if (err) {\r\n        return cb(new SimpleKerberosError('Simple Kerberos failed at \"step\" stage', err));\r\n      }\r\n\r\n      const {username} = context;\r\n\r\n      kerberos.authGSSServerClean(context, err => {\r\n        if (err) {\r\n          return cb(new SimpleKerberosError('Simple Kerberos failed at \"clean\" stage', err));\r\n        }\r\n\r\n        cb(null, username);\r\n      });\r\n    });\r\n  });\r\n});\r\n"]}